//*****************************************************************************
// Mucom88 Test Project
//*****************************************************************************

//-----------------------------------------------------------------------------
// Include
//-----------------------------------------------------------------------------
#include <genesis.h>

#include "mucom88mdz_test.h"

//-----------------------------------------------------------------------------
// Game 変数
//-----------------------------------------------------------------------------
typedef struct _GAME_WORK
{
	u8 rno[4];
	u8 ctr[4];
} GAME_WORK;

static GAME_WORK game_work;

//-----------------------------------------------------------------------------
// Declaration
//-----------------------------------------------------------------------------
int main();

void VBlank_func();

void GameInit();
void GameMain();

//*****************************************************************************
// Program
//*****************************************************************************

//-----------------------------------------------------------------------------
// VBlank開始後に割り込む関数
//-----------------------------------------------------------------------------
void VBlank_func()
{
	VDP_updateSprites(0, FALSE); //スプライトの更新

	//FPSの表示
/*
	char str[16];
	fix32ToStr(getFPS_f(), str, 1);
	VDPPlan plan;
	plan.value = VDP_PLAN_A;
	VDP_drawTextBG(plan, str, 35, 1);
*/
}

//-----------------------------------------------------------------------------
// Main
//-----------------------------------------------------------------------------
int main()
{
	u32 Gametime = 0;

	SYS_setVIntCallback(VBlank_func);

	GameInit();

	while (1) //ゲームループ
	{

		GameMain();

		Gametime++;

		VDP_waitVSync(); //VSync待ち（秒間60フレーム）
	}
	return (0);
}


//-----------------------------------------------------------------------------
// Game Init
//-----------------------------------------------------------------------------
void GameInit()
{
	memset(&game_work, 0, sizeof(GAME_WORK));

	JoySystemInitilize();

	Mucom88mdz_TestInit();
}

//-----------------------------------------------------------------------------
// Game Main
//-----------------------------------------------------------------------------
void GameMain()
{

	switch (game_work.rno[0])
	{
	case 0:
		JoyDataUpdate();
		Mucom88mdz_TestUpdate();
		break;
	default:
		break;
	}
}
